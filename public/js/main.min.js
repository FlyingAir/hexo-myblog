"use strict";!function(s,n){var h=n.body,c=n.querySelector.bind(n),a=n.querySelectorAll.bind(n),o=c("html"),e=c("#gotop"),r=c("#menu"),d=c("#main"),i=c("#header"),l=c("#mask"),t=c("#menu-toggle"),u=c("#menu-off"),f=c(".header-title"),v=c("#loading"),g=-1!==location.href.indexOf("post"),m=s.requestAnimationFrame,L=Array.prototype.forEach,p=/micromessenger/i.test(navigator.userAgent),w=function(){},y=function t(e){var i=e.offsetLeft,s=e.offsetTop;if(e.offsetParent){var n=t(e.offsetParent);i+=n.x,s+=n.y}return{x:i,y:s}},x="ontouchstart"in s&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)?"touchstart":"click",E=n.documentElement;600<s.innerWidth?(-1<window.navigator.userAgent.indexOf("WOW")||-1<window.navigator.userAgent.indexOf("Edge")||-1<window.navigator.userAgent.indexOf("MSIE"))&&-1===window.navigator.userAgent.indexOf("Trident")&&(E=h):-1<window.navigator.userAgent.indexOf("Android")&&-1<window.navigator.userAgent.indexOf("Browser")&&(E=h);var $,T,O={goTop:function(t){var e=E.scrollTop,i=2<arguments.length?arguments[1]:Math.abs(e-t)/12;e&&t<e?(E.scrollTop=Math.max(e-i,0),m(arguments.callee.bind(this,t,i))):t&&e<t?(E.scrollTop=Math.min(e+i,t),m(arguments.callee.bind(this,t,i))):this.toc.actived(t)},toggleGotop:function(t){t>s.innerHeight/2?e.classList.add("in"):e.classList.remove("in")},toggleMenu:function(t){if(t){if(r.classList.remove("hide"),g||(d.classList.remove("menuoff"),jQuery(f).animate({marginRight:"-20%"})),s.innerWidth<1241)if(l.classList.add("in"),r.classList.add("show"),p){var e=E.scrollTop;d.classList.add("lock"),d.scrollTop=e}else o.classList.add("lock")}else if(l.classList.remove("in"),r.classList.remove("show"),p){var i=d.scrollTop;d.classList.remove("lock"),E.scrollTop=i}else o.classList.remove("lock")},fixedHeader:function(t){t>i.clientHeight?i.classList.add("fixed"):i.classList.remove("fixed")},toc:function(){var s=c("#post-toc");if(!s||!s.children.length)return g&&d.classList.add("show"),{fixed:w,actived:w};var e=c(".post-header").clientHeight,n=i.clientHeight,a=c("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6");return s.querySelector('a[href="#'+a[0].id+'"]').parentNode.classList.add("active"),d.classList.add("tocshow"),f.classList.add("toc"),c(".footer").classList.add("toc"),{fixed:function(t){e-n<=t?s.classList.add("fixed"):s.classList.remove("fixed")},actived:function(t){for(var e=0,i=a.length;e<i;e++){if(t>y(a[e]).y-n-5)s.querySelector("li.active").classList.remove("active"),s.querySelector('a[href="#'+a[e].id+'"]').parentNode.classList.add("active")}t<y(a[0]).y&&(s.querySelector("li.active").classList.remove("active"),s.querySelector('a[href="#'+a[0].id+'"]').parentNode.classList.add("active"))}}}(),hideOnMask:[],modal:function(t){this.$modal=c(t),this.$off=this.$modal.querySelector(".close");var e=this;this.show=function(){l.classList.add("in"),800<s.innerWidth&&(d.classList.add("Mask"),r.classList.add("Mask")),e.$modal.classList.add("ready"),setTimeout(function(){e.$modal.classList.add("in")},0)},this.onHide=w,this.hide=function(){if(e.onHide(),l.classList.remove("in"),800<s.innerWidth){d.classList.remove("Mask"),r.classList.remove("Mask");var t=n.querySelector(".imgShow");t&&document.body.removeChild(t)}e.$modal.classList.remove("in"),setTimeout(function(){e.$modal.classList.remove("ready")},300)},this.toggle=function(){return e.$modal.classList.contains("in")?e.hide():e.show()},O.hideOnMask.push(this.hide),this.$off&&this.$off.addEventListener(x,this.hide)},share:function(){var e=c("#pageShare"),i=c("#shareFab"),t=new this.modal("#globalShare");i&&(i.addEventListener(x,function(){e.classList.toggle("in")},!1),n.addEventListener(x,function(t){i.contains(t.target)||e.classList.remove("in")},!1));var s=new this.modal("#wxShare");s.onHide=t.hide,L.call(a(".wxFab"),function(t){t.addEventListener(x,s.toggle)})},reward:function(){var t=new this.modal("#reward"),e=c("#rewardCode"),i=c("#rewardToggle"),s=!1,n=-1,a=c(".wechatPay"),o=c(".alipayPay"),r=c(".icon-caret-up");c("#rewardBtn").addEventListener(x,function(){-1===n?e.src=e.dataset.img:1===n?e.src=i.dataset.alipay:0===n&&(e.src=i.dataset.wechat),t.toggle()}),a.addEventListener("click",function(){s=!0}),i&&i.addEventListener("change",function(){n=this.checked?s?(e.src=this.dataset.wechat,o.classList.remove("show"),a.classList.add("show"),r.style="margin-left:-20%;",0):(e.src=this.dataset.alipay,o.classList.add("show"),a.classList.remove("show"),r.style="margin-left:20%;",this.checked=!1,1):(e.src=this.dataset.alipay,o.classList.add("show"),a.classList.remove("show"),r.style="margin-left:20%;",1)})},tabBar:function(t){t.parentNode.parentNode.classList.toggle("expand")},page:($=a(".fade, .fade-scale"),T=!1,{loaded:function(){L.call($,function(t){t.classList.add("in")}),T=!0},unload:function(){L.call($,function(t){t.classList.remove("in")}),T=!1},visible:T}),lightbox:function(){function e(t){this.$img=t.querySelector("img"),this.$overlay=t.querySelector("overlay"),this.margin=40,this.title=this.$img.title||this.$img.alt||"",this.isZoom=!1;var o=void 0,r=void 0,c=void 0,d=void 0,l=void 0;this.calcRect=function(){d=h.clientWidth;var t=(l=h.clientHeight)-2*this.margin,e=o,i=r,s=(this.margin,d<e?d/e:1),n=t<i?t/i:1,a=Math.min(s,n);return{w:e*=a,h:i*=a,t:(l-i)/2-c.top,l:(d-e)/2-c.left+this.$img.offsetLeft}},this.setImgRect=function(t){this.$img.style.cssText="width: "+t.w+"px; max-width: "+t.w+"px; height:"+t.h+"px; top: "+t.t+"px; left: "+t.l+"px"},this.setFrom=function(){this.setImgRect({w:c.width,h:c.height,t:0,l:(t.offsetWidth-c.width)/2})},this.setTo=function(){this.setImgRect(this.calcRect())},this.addTitle=function(){this.title&&(this.$caption=n.createElement("div"),this.$caption.innerHTML=this.title,this.$caption.className="overlay-title",t.appendChild(this.$caption))},this.removeTitle=function(){this.$caption&&t.removeChild(this.$caption)};var e=this;this.zoomIn=function(){o=this.$img.naturalWidth||this.$img.width,r=this.$img.naturalHeight||this.$img.height,c=this.$img.getBoundingClientRect(),t.style.height=c.height+"px",t.classList.add("ready"),this.setFrom(),this.addTitle(),this.$img.classList.add("zoom-in"),setTimeout(function(){t.classList.add("active"),e.setTo(),e.isZoom=!0},0)},this.zoomOut=function(){this.isZoom=!1,t.classList.remove("active"),this.$img.classList.add("zoom-in"),this.setFrom(),setTimeout(function(){e.$img.classList.remove("zoom-in"),e.$img.style.cssText="",e.removeTitle(),t.classList.remove("ready"),t.removeAttribute("style")},300)},t.addEventListener("click",function(t){e.isZoom?e.zoomOut():"IMG"===t.target.tagName&&e.zoomIn()}),n.addEventListener("scroll",function(){e.isZoom&&e.zoomOut()}),s.addEventListener("resize",function(){e.isZoom&&e.zoomOut()})}L.call(a(".img-lightbox"),function(t){new e(t)})}(),loadScript:function(t){t.forEach(function(t){var e=n.createElement("script");e.src=t,e.async=!0,h.appendChild(e)})}};s.addEventListener("load",function(){v.classList.remove("active"),O.page.loaded(),s.lazyScripts&&s.lazyScripts.length&&O.loadScript(s.lazyScripts)}),s.addEventListener("DOMContentLoaded",function(){var t=E.scrollTop;O.toc.fixed(t),O.toc.actived(t),O.page.loaded()});var k=!1,S=c('a[href^="mailto"]');S&&S.addEventListener(x,function(){k=!0}),s.addEventListener("beforeunload",function(){k?k=!1:O.page.unload()}),s.addEventListener("pageshow",function(){O.page.visible||O.page.loaded()}),s.addEventListener("resize",function(){x="ontouchstart"in s?"touchstart":"click",s.BLOG.even=x,O.toggleMenu()}),e.addEventListener(x,function(){m(O.goTop.bind(O,0))},!1),t.addEventListener(x,function(t){O.toggleMenu(!0),t.preventDefault()},!1),u.addEventListener(x,function(){r.classList.add("hide"),g||(d.classList.add("menuoff"),jQuery(f).animate({marginRight:"-3%"}))},!1),l.addEventListener(x,function(t){O.toggleMenu(),O.hideOnMask.forEach(function(t){t()}),t.preventDefault()},!1),n.addEventListener("scroll",function(){var t=E.scrollTop;O.toggleGotop(t),O.fixedHeader(t),O.toc.fixed(t),O.toc.actived(t)},!1),s.BLOG.SHARE&&g&&O.share(),s.BLOG.REWARD&&O.reward(),O.noop=w,O.even=x,O.$=c,O.$$=a,Object.keys(O).reduce(function(t,e){return t[e]=O[e],t},s.BLOG),s.Waves?(Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])):console.error("Waves loading failed.")}(window,document),function(){var s=window||this,e=s.BLOG.even,t=s.BLOG.$,i=t("#search"),n=t("#search-wrap"),a=t("#key"),o=t("#back"),r=t("#search-panel"),c=t("#search-result"),d=t("#search-tpl").innerHTML,l=(s.BLOG.ROOT+"/content.json").replace(/\/{2}/g,"/"),h=void 0;var u=t("html"),f={show:function(){s.innerWidth<760&&u.classList.add("lock-size"),r.classList.add("in")},hide:function(){s.innerWidth<760&&u.classList.remove("lock-size"),r.classList.remove("in")}};function v(t,e){return e.lastIndex=0,e.test(t)}function g(t){var e=this.value.trim();if(e){var i=new RegExp(e.replace(/[ ]/g,"|"),"gmi");!function(e){if(h)e(h);else{var t=new XMLHttpRequest;t.open("GET",l,!0),t.onload=function(){if(200<=this.status&&this.status<300){var t=JSON.parse(this.response);h=t instanceof Array?t:t.posts,e(h)}else console.error(this.statusText)},t.onerror=function(){console.error(this.statusText)},t.send()}}(function(t){!function(t){var e="";e=t.length?t.map(function(t){return function(t,i){return t.replace(/\{\w+\}/g,function(t){var e=t.replace(/\{|\}/g,"");return i[e]||""})}(d,{title:t.title,path:(s.BLOG.ROOT+"/"+t.path).replace(/\/{2,}/g,"/"),date:new Date(t.date).toLocaleDateString(),tags:t.tags.map(function(t){return"<span>#"+t.name+"</span>"}).join("")})}).join(""):'<li class="tips"><i class="icon icon-coffee icon-3x"></i><p>Results not found!</p></li>',c.innerHTML=e}(t.filter(function(t){return function(t,e){return v(t.title,e)||t.tags.some(function(t){return v(t.name,e)})||v(t.text,e)}(t,i)})),f.show()}),t.preventDefault()}}i.addEventListener(e,function(){n.classList.toggle("in"),a.value="",n.classList.contains("in")?a.focus():a.blur()}),o.addEventListener(e,function(){n.classList.remove("in"),f.hide()}),document.addEventListener(e,function(t){"key"!==t.target.id&&"click"===e&&f.hide()}),a.addEventListener("input",g),a.addEventListener(e,g)}.call(void 0);